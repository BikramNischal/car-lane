var P=Object.defineProperty;var C=(t,e,n)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var c=(t,e,n)=>(C(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))h(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&h(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function h(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function u(t){return Math.ceil(Math.random()*t)}const a=document.querySelector("#canvas"),y=a.getContext("2d");a.height=a.clientHeight;a.width=a.clientWidth;const S=document.querySelector(".start-window"),L=document.querySelector(".game-window"),R=document.querySelector(".end-window");function W(){S.style.display="flex",L.style.display="none",R.style.display="none"}function q(){S.style.display="none",L.style.display="block",R.style.display="none"}function p(){S.style.display="none",L.style.display="none",R.style.display="flex"}class I{constructor(e,n,h,i,s,r=5){c(this,"x");c(this,"y");c(this,"w");c(this,"h");c(this,"move");c(this,"imgsrc");this.x=e,this.y=n,this.w=h,this.h=i,this.move=r,this.imgsrc=s}drawCar(){const e=new Image;e.src=this.imgsrc,y.drawImage(e,this.x,this.y,this.w,this.h)}moveRight(){this.x+=this.move}moveLeft(){this.x-=this.move}moveDown(){this.y+=this.move}resetY(){this.y=-150}collision(e){if(this.x<e.x+e.w&&this.x+this.w>e.x&&this.y<e.y+e.h&&this.y+this.h>e.y)return console.log("collision"),!0}}const o=a.width,D=a.height;class f{constructor(e,n,h,i,s=5){c(this,"x");c(this,"y");c(this,"w");c(this,"h");c(this,"dy");this.x=e,this.y=n,this.w=h,this.h=i,this.dy=s}drawRoadLine(){y.fillStyle="white",y.fillRect(this.x,this.y,this.w,this.h)}move(){this.y+=this.dy,this.y>D&&(this.y=-this.h)}}const d=o/4,E={0:d/2,1:d/2+d,2:d/2+2*d,3:d/2+3*d},g=[],G=new f(o/4,0,10,200),H=new f(o/2,0,10,200),B=new f(o/4+o/2,0,10,200),Y=new f(o/4,325,10,200),$=new f(o/2,325,10,200),k=new f(o/4+o/2,325,10,200),F=new f(o/4,650,10,200),K=new f(o/2,650,10,200),T=new f(o/4+o/2,650,10,200);g.push(G,H,B,Y,$,k,F,K,T);const j=["./enemy1.png","./enemy2.png","./enemy3.png"];function O(){const t=[],e=[];for(let n=0;n<4;++n){const h=u(2),i=u(3);if(t.indexOf(i)!==-1)continue;t.push(i);const r={car:new I(E[i]-50,-150,100,150,j[h]),laneNo:i};e.push(r)}return e}function A(t,e,n,h,i=1){const s=setInterval(()=>{i===1?t.moveRight():t.moveLeft(),y.clearRect(0,0,a.width,a.height),M(),h.forEach(r=>{r.drawRoadLine()}),e.forEach(r=>{r.car.drawCar(),t.collision(r.car)&&(p(),x(),clearInterval(s))}),t.drawCar(),t.x+t.w/2>=n&&i===1&&clearInterval(s),t.x+t.w/2<=n&&i===-1&&clearInterval(s),(t.x<0||t.x+t.w>a.width)&&(p(),x(),clearInterval(s))},10)}function z(t,e){const n=t.x+t.w/2+d;A(t,e,n,g)}function J(t,e){const n=t.x+t.w/2-d;A(t,e,n,g,-1)}const Q=a.width,w=a.height,U=document.querySelector(".btn--start"),V=document.querySelector(".btn--restart");let b=0,m=new I(E[1]-75,w-150,150,150,"./player.png"),l=O(),v=u(l.length);function M(){y.fillStyle="white",y.font="50px Arial",y.fillText("Score : "+b,10,100)}function x(){m=new I(E[1]-75,w-150,150,150,"./player.png"),l=O(),v=u(l.length),b=0}function N(){const t=setInterval(()=>{let e=!1;y.clearRect(0,0,Q,w),M();for(let n=0;n<v;++n)l[n].car.moveDown(),l[n].car.drawCar(),m.collision(l[n].car)&&(p(),x(),clearInterval(t)),l[n].car.y>w&&(l[n].car.resetY(),b+=1,e=!0);if(e){l=O();const n=u(l.length);v=n||2,e=!1}g.forEach(n=>{n.drawRoadLine(),n.move()}),m.drawCar()},10);document.addEventListener("keydown",e=>{e.key==="ArrowRight"&&z(m,l),e.key==="ArrowLeft"&&J(m,l)})}W();U.onclick=()=>{q(),N()};V.onclick=()=>{q(),N()};
