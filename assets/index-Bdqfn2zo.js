var G=Object.defineProperty;var H=(t,e,i)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var r=(t,e,i)=>(H(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const y of s.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&a(y)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();function x(t){return Math.floor(Math.random()*t)}const c=document.querySelector("#canvas"),f=c.getContext("2d");c.height=c.clientHeight;c.width=c.clientWidth;const R=document.querySelector(".start-window"),E=document.querySelector(".game-window"),b=document.querySelector(".end-window");function B(){R.style.display="flex",E.style.display="none",b.style.display="none"}function P(){R.style.display="none",E.style.display="block",b.style.display="none"}function S(){R.style.display="none",E.style.display="none",b.style.display="flex"}class O{constructor(e,i,a,n,s,y=5){r(this,"x");r(this,"y");r(this,"w");r(this,"h");r(this,"move");r(this,"imgsrc");this.x=e,this.y=i,this.w=a,this.h=n,this.move=y,this.imgsrc=s}drawCar(){const e=new Image;e.src=this.imgsrc,f.drawImage(e,this.x,this.y,this.w,this.h)}moveRight(){this.x+=this.move}moveLeft(){this.x-=this.move}moveDown(e){this.y+=e}resetY(){this.y=0-this.h}collision(e){if(this.x<e.x+e.w&&this.x+this.w>e.x&&this.y<e.y+e.h&&this.y+this.h>e.y)return!0}}const o=c.width,Y=c.height;class d{constructor(e,i,a,n,s=3){r(this,"x");r(this,"y");r(this,"w");r(this,"h");r(this,"dy");this.x=e,this.y=i,this.w=a,this.h=n,this.dy=s}drawRoadLine(){f.fillStyle="white",f.fillRect(this.x,this.y,this.w,this.h)}move(){this.y+=this.dy,this.y>Y&&(this.y=-this.h)}}const h=o/4,q={0:h/2,1:h/2+h,2:h/2+2*h,3:h/2+3*h},v=[],$=new d(o/4,0,10,200),k=new d(o/2,0,10,200),F=new d(o/4+o/2,0,10,200),K=new d(o/4,325,10,200),T=new d(o/2,325,10,200),j=new d(o/4+o/2,325,10,200),z=new d(o/4,650,10,200),J=new d(o/2,650,10,200),Q=new d(o/4+o/2,650,10,200);v.push($,k,F,K,T,j,z,J,Q);const U=["./enemy1.png","./enemy2.png","./enemy3.png"];function A(){const t=[],e=[];for(let i=0;i<4;++i){const a=x(2),n=x(4);if(t.indexOf(n)!==-1)continue;t.push(n);const y={car:new O(q[n]-50,-150,100,150,U[a]),laneNo:n};e.push(y)}return e}let u=null;function C(t,e,i,a,n=1){u===null&&(u=setInterval(()=>{n===1?t.moveRight():t.moveLeft(),f.clearRect(0,0,c.width,c.height),W(),a.forEach(s=>{s.drawRoadLine()}),e.forEach(s=>{if(s.car.drawCar(),t.collision(s.car)){p(),S(),clearInterval(u),u=null;return}}),t.drawCar(),(t.x+t.w/2>=i&&n===1||t.x+t.w/2<=i&&n===-1)&&(clearInterval(u),u=null),(t.x<0||t.x+t.w>c.width)&&(S(),p(),clearInterval(u),u=null)},10))}function V(t,e){const i=t.x+t.w/2+h;C(t,e,i,v)}function X(t,e){const i=t.x+t.w/2-h;C(t,e,i,v,-1)}const Z=c.width,g=c.height,_=document.querySelector(".btn--start"),ee=document.querySelector(".btn--restart");let M=0,m=null,w=new O(q[1]-75,g-150,150,150,"./player.png"),l=A();const N=t=>{let e=x(t);return e||2};let L=N(l.length),I=3;function W(){f.fillStyle="white",f.font="50px Arial",f.fillText("Score : "+M,10,100)}function p(){w=new O(q[1]-75,g-150,150,150,"./player.png"),l=A(),L=N(l.length),M=0,I=3,m!==null&&(clearInterval(m),m=null)}function D(){m===null&&(m=setInterval(()=>{let t=!1;f.clearRect(0,0,Z,g),W();for(let e=0;e<L;++e){if(l[e].car.moveDown(I),l[e].car.drawCar(),w.collision(l[e].car)){S(),clearInterval(m),m=null,p();return}l[e].car.y>g&&(l[e].car.resetY(),M+=1,I+=.3,t=!0)}t&&(l=A(),L=N(l.length),t=!1),v.forEach(e=>{e.drawRoadLine(),e.move()}),w.drawCar()},10))}document.addEventListener("keydown",t=>{t.key==="ArrowRight"&&V(w,l),t.key==="ArrowLeft"&&X(w,l)});B();_.onclick=()=>{P(),D()};ee.onclick=()=>{p(),P(),D()};
